"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[837],{8012:function(e,t,r){r.d(t,{qn:function(){return h},fR:function(){return y},fD:function(){return f}});r(8010),r(3238),r(1013),r(2571),r(5901),r(252),r(5849),r(4009);var n=r(1549),o=r(3719),i=r(6942),c=function(e){var t=e.slug;return i.v_("articles/".concat(t,"/favorite")).then((function(e){return e.data}))},a=function(e){var t=e.slug;return i.IV("articles/".concat(t,"/favorite")).then((function(e){return e.data}))};function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){var t=e.effect,r=(0,n.yM)(),i=r.filter({fn:function(e){return!0===e.favorited}}),s=r.filter({fn:function(e){return!1===e.favorited}}),l=(0,n.GW)(c),f=(0,n.GW)(a),d=(0,n.MT)({articlesCount:0,articles:[]}).on(t.doneData,(function(e,t){return t})).on(i,(function(e,t){return u(u({},e),{},{articles:e.articles.map((function(e){return e.slug!==t.slug?e:u(u({},e),{},{favorited:!e.favorited,favoritesCount:e.favoritesCount-1})}))})})).on(s,(function(e,t){return u(u({},e),{},{articles:e.articles.map((function(e){return e.slug!==t.slug?e:u(u({},e),{},{favorited:!e.favorited,favoritesCount:e.favoritesCount+1})}))})})).on([l.done,f.done],(function(e,t){var r=t.params,n=t.result;return u(u({},e),{},{articles:e.articles.map((function(e){return e.slug!==r.slug?e:u(u({},e),{},{favorited:n.article.favorited,favoritesCount:n.article.favoritesCount})}))})})).on([l.fail,f.fail],(function(e,t){var r=t.params;return u(u({},e),{},{articles:e.articles.map((function(e){return e.slug!==r.slug?e:u(u({},e),{},{favorited:r.favorited,favoritesCount:r.favoritesCount})}))})})),m=d.map((function(e){return e.articlesCount})),j=d.map((function(e){return e.articles})),v=(0,o.status)({effect:t}),h=(0,n.$e)(v,j,(function(e,t){return("done"===e||"fail"===e)&&0===t.length}));return(0,n.Vl)({source:r,match:{favorite:function(e){return!0===e.favorited},unfavorite:function(e){return!1===e.favorited}},cases:{favorite:f,unfavorite:l}}),{favoriteArticleToggled:r,setUnfavoriteArticleFx:f,$feed:d,$totalPages:m,$articles:j,$isEmptyFeed:h}}var d=r(4246),m=function(e){var t=e.children;return(0,d.jsx)("ul",{className:"articles-wrapper list-unstyled",children:t})},j=r(7378),v=r(4289),h=(0,j.memo)((function(e){var t=e.author,r=e.createdAt,n=e.children;return(0,d.jsxs)("div",{className:"article-meta",children:[(0,d.jsx)(v.rU,{to:"/@".concat(t.username),children:(0,d.jsx)("img",{alt:t.username,src:t.image})}),(0,d.jsxs)("div",{className:"info",children:[(0,d.jsx)(v.rU,{className:"author",to:"/@".concat(t.username),children:t.username}),(0,d.jsx)("span",{className:"date",children:new Date(r).toDateString()})]}),n]})}));h.displayName="ArticleMeta";r(2189);var p=r(9261),b=function(e){var t=e.slug,r=e.favorited,n=e.favoritesCount,o=e.onClick,i=e.children;return(0,d.jsxs)(p.zx,{className:"button-favorite btn-outline-primary","data-active":r,size:"sm",onClick:function(){o({slug:t,favorited:r,favoritesCount:n})},children:[(0,d.jsx)("i",{className:"ion-heart"})," ",i]})},g=(0,j.memo)((function(e){var t=e.author,r=e.createdAt,n=e.slug,o=e.title,i=e.description,c=e.tagList,a=e.favorited,s=e.favoritesCount,u=e.onFavoriteToggle;return(0,d.jsxs)("article",{className:"article-preview",children:[(0,d.jsx)(h,{author:t,createdAt:r,children:(0,d.jsx)("div",{className:"pull-xs-right",children:(0,d.jsx)(b,{favorited:a,favoritesCount:s,slug:n,onClick:u,children:s})})}),(0,d.jsxs)(v.rU,{className:"preview-link",to:"/article/".concat(n),children:[(0,d.jsx)("h1",{children:o}),(0,d.jsx)("p",{children:i}),(0,d.jsx)("span",{children:"Read more..."}),(0,d.jsx)(p.oS,{children:c.map((function(e){return(0,d.jsx)(p.Vp,{children:e.toLowerCase()},e)}))})]})]})}));g.displayName="Article Preview";var x=function(e){return e.show?(0,d.jsx)("div",{className:"empty-articles article-preview",children:"No articles are here... yet."}):null},O=r(9041),y=function(e){var t=e.loading,r=e.isEmpty,n=e.articlesStore,o=e.onFavoriteToggle;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(x,{show:r}),(0,d.jsx)(m,{children:(0,O.sm)(n,{getKey:function(e){return e.slug},fn:function(e){return(0,d.jsx)("li",{children:(0,d.jsx)(g,{author:e.author,createdAt:e.createdAt,description:e.description,favorited:e.favorited,favoritesCount:e.favoritesCount,slug:e.slug,tagList:e.tagList,title:e.title,onFavoriteToggle:o})})}})}),(0,d.jsx)(p.$j,{show:t})]})}},1837:function(e,t,r){r.r(t),r.d(t,{default:function(){return ae}});var n=r(7378),o=r(9635),i=r(4931),c=(r(2571),r(5901),r(8010),r(3238),r(252),r(5849),r(4009),r(8039)),a=r(9261),s=(r(3938),r(1013),r(2595),r(1549)),u=r(9041),l=r(6942),f=(0,s.yM)(),d=(0,s.GW)((function(e){return l.U2("articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))})),m=(0,s.GW)((function(e){var t=e.slug,r=e.body;return l.v_("articles/".concat(t,"/comments"),{comment:{body:r}}).then((function(e){return e.data.comment}))})),j=(0,s.GW)((function(e){var t=e.slug,r=e.id;l.IV("articles/".concat(t,"/comments/").concat(r))}));(0,s.eH)({from:f,to:j});var v=(0,s.nu)(d.doneData,[]).on(m.doneData,(function(e,t){return[t].concat(e)})).on(j.done,(function(e,t){var r=t.params;return e.filter((function(e){return e.id!==r.id}))})),h=(0,u.Bq)(),p=(0,s.MT)({errors:{}}).on([m.failData,j.failData],(function(e,t){var r;return null===(r=t.response)||void 0===r?void 0:r.data})).reset(h.close),b=p.map((function(e){return Object.keys(Object(e)).length>0})),g=p.map((function(e){return Object.entries(Object(null==e?void 0:e.errors))})),x=function(){return(0,u.oR)(b)},O=function(){return(0,u.oR)(g)},y=r(4246),w=function(){var e=i.wl.useVisitor(),t=e.image,r=e.username;return(0,y.jsxs)("div",{className:"card-footer",children:[(0,y.jsx)("img",{alt:r,className:"comment-author-img",src:t}),(0,y.jsx)(a.zx,{className:"btn-primary",size:"sm",type:"submit",children:"Post Comment"})]})};function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){D(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(){var e=function(){var e={body:""},t=(0,o.UO)().slug,r=(0,c.cI)({defaultValues:e}),i=r.handleSubmit,a=r.register,s=r.reset;return(0,n.useEffect)((function(){var t=m.done.watch((function(){s(e)}));return function(){return t()}})),{register:a,handleSubmit:i((function(e){var r=e.body;m({body:r,slug:t})}))}}(),t=e.handleSubmit,r=e.register;return(0,y.jsxs)(a.l0,{className:"card comment-form",onSubmit:t,children:[(0,y.jsx)("div",{className:"card-block",children:(0,y.jsx)(a.l0.Control,N({as:"textarea",placeholder:"Write a comment...",rows:3},r("body")))}),(0,y.jsx)(w,{})]})}var A=r(4289),S=function(e){var t=e.author,r=e.onClick,n=i.wl.useVisitor().username,o=i.wl.useIsAuthorized(),c=n===t.username;return o&&c?(0,y.jsx)(a.zx,{className:"mod-options btn-delete",onClick:r,children:(0,y.jsx)("i",{className:"ion-trash-a"})}):null},k=function(e){var t=e.author,r=e.createdAt,n=e.id,i=(0,o.UO)().slug;return(0,y.jsxs)("div",{className:"card-footer",children:[(0,y.jsx)(A.rU,{className:"comment-author",to:"/@".concat(t.username),children:(0,y.jsx)("img",{alt:t.username,className:"comment-author-img",src:t.image})})," ",(0,y.jsx)(A.rU,{className:"comment-author",to:"/@".concat(t.username),children:t.username}),(0,y.jsx)("span",{className:"date-posted",children:new Date(r).toDateString()}),(0,y.jsx)(S,{author:t,onClick:function(){f({slug:i,id:n})}})]})},E=["body"];function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var L=function(e){var t=e.body,r=I(e,E);return(0,y.jsxs)("div",{className:"card",children:[(0,y.jsx)("div",{className:"card-block",children:(0,y.jsx)("p",{className:"card-text",children:t})}),(0,y.jsx)(k,z({},r))]})},W=function(){var e=(0,o.UO)().slug;return(0,n.useEffect)((function(){e&&d(e)}),[e]),(0,y.jsx)(a.aV,{children:(0,u.sm)(v,{getKey:function(e){return e.id},fn:function(e){return(0,y.jsx)(L,{author:e.author,body:e.body,createdAt:e.createdAt,id:e.id})}})})},F=function(){(0,u.DD)(h);var e=x(),t=O();return e?(0,y.jsx)(a.KM,{errors:t}):null},G=function(){return i.wl.useIsAuthorized()?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(F,{}),(0,y.jsx)(C,{}),(0,y.jsx)(W,{})]}):null},M=r(9721),R=["createdAt"];function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var H=(0,s.yM)(),X=(0,s.GW)((function(e){return l.U2("articles/".concat(e)).then((function(e){return e.data.article})).then((function(e){var t=e.createdAt;return $($({},K(e,R)),{},{createdAt:new Date(t).toDateString()})}))})),_=(0,s.GW)((function(e){return l.IV("articles/".concat(e))})),B=(0,s.nu)(X.doneData,{title:"",slug:"",body:"",createdAt:"",updatedAt:"",tagList:[],description:"",author:{username:"",bio:"",image:"",following:!1},favorited:!1,favoritesCount:0}),Z=(0,s.$e)(B,i.Sj,(function(e,t){return e.author.username===t.username}));(0,s.eH)({from:H,to:_}),_.done.watch((function(){M.m8.push("/")}));var J=function(){return(0,u.oR)(X.pending)},Q=function(){return(0,u.oR)(Z)},Y=function(){return(0,u.oR)(B)},ee=r(8781),te=function(){var e=Y().tagList;return(0,y.jsx)(a.oS,{children:e.map((function(e){return(0,y.jsx)(a.Vp,{children:e.toLowerCase()},e)}))})},re=function(){var e=Y().body;return(0,y.jsx)(a.X2,{className:"article-content",children:(0,y.jsxs)("div",{className:"col-xs-12",children:[(0,y.jsx)(ee.Z,{children:e}),(0,y.jsx)(te,{})]})})},ne=r(8012),oe=function(){var e=Q(),t=Y().slug;return e?(0,y.jsxs)("span",{children:[(0,y.jsx)(A.rU,{to:"/editor/".concat(t),children:(0,y.jsxs)(a.zx,{className:"btn-outline-secondary",size:"sm",children:[(0,y.jsx)("i",{className:"ion-edit"})," Edit Article"]})}),(0,y.jsxs)(a.zx,{className:"btn-sm btn-outline-danger",onClick:function(){H(t)},children:[(0,y.jsx)("i",{className:"ion-trash-a"})," Delete Article"]})]}):null},ie=function(){var e=Y(),t=e.title,r=e.author,n=e.createdAt;return(0,y.jsx)(a.jL,{children:(0,y.jsxs)(a.W2,{children:[(0,y.jsx)("h1",{children:t}),(0,y.jsx)(ne.qn,{author:r,createdAt:n,children:(0,y.jsx)(oe,{})})]})})},ce=function(){return i.wl.useIsAuthorized()?null:(0,y.jsxs)("p",{children:[(0,y.jsx)(A.rU,{to:"/login",children:"Sign in"})," or ",(0,y.jsx)(A.rU,{to:"/register",children:"sign up"})," to add comments on this article."]})},ae=function(){var e=(0,o.UO)().slug,t=J();return(0,n.useLayoutEffect)((function(){e&&X(e)}),[e]),t?null:(0,y.jsxs)("div",{className:"article-page",children:[(0,y.jsx)(ie,{}),(0,y.jsxs)(a.T3,{children:[(0,y.jsx)(re,{}),(0,y.jsx)("hr",{}),(0,y.jsx)("div",{className:"article-actions"}),(0,y.jsx)(a.X2,{children:(0,y.jsxs)("div",{className:"col-xs-12 col-md-8 offset-md-2",children:[(0,y.jsx)(G,{}),(0,y.jsx)(ce,{})]})})]})]})}}}]);