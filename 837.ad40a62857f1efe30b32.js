"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[837],{8012:function(e,r,t){t.d(r,{qn:function(){return b},fR:function(){return P},fD:function(){return m}});var n=t(1549),o=t(3719),a=t(6942);function i(e,r,t,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?r(s):Promise.resolve(s).then(n,o)}function c(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function c(e){i(a,n,o,c,s,"next",e)}function s(e){i(a,n,o,c,s,"throw",e)}c(void 0)}))}}var s=function(){var e=c(regeneratorRuntime.mark((function e(r){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.slug,e.next=3,a.v_("articles/".concat(t,"/favorite"));case 3:return n=e.sent,o=n.data,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),u=function(){var e=c(regeneratorRuntime.mark((function e(r){var t,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.slug,e.next=3,a.IV("articles/".concat(t,"/favorite"));case 3:return n=e.sent,o=n.data,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){d(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function d(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function m(e){var r=e.effect,t=(0,n.yM)(),a=t.filter({fn:function(e){return!0===e.favorited}}),i=t.filter({fn:function(e){return!1===e.favorited}}),c=(0,n.GW)(s),l=(0,n.GW)(u),d=(0,n.MT)({articlesCount:0,articles:[]}).on(r.doneData,(function(e,r){return r})).on(a,(function(e,r){return f(f({},e),{},{articles:e.articles.map((function(e){return e.slug!==r.slug?e:f(f({},e),{},{favorited:!e.favorited,favoritesCount:e.favoritesCount-1})}))})})).on(i,(function(e,r){return f(f({},e),{},{articles:e.articles.map((function(e){return e.slug!==r.slug?e:f(f({},e),{},{favorited:!e.favorited,favoritesCount:e.favoritesCount+1})}))})})).on([c.done,l.done],(function(e,r){var t=r.params,n=r.result;return f(f({},e),{},{articles:e.articles.map((function(e){return e.slug!==t.slug?e:f(f({},e),{},{favorited:n.article.favorited,favoritesCount:n.article.favoritesCount})}))})})).on([c.fail,l.fail],(function(e,r){var t=r.params;return f(f({},e),{},{articles:e.articles.map((function(e){return e.slug!==t.slug?e:f(f({},e),{},{favorited:t.favorited,favoritesCount:t.favoritesCount})}))})})),m=d.map((function(e){return e.articlesCount})),v=d.map((function(e){return e.articles})),p=(0,o.status)({effect:r}),h=(0,n.$e)(p,v,(function(e,r){return("done"===e||"fail"===e)&&0===r.length}));return(0,n.Vl)({source:t,match:{favorite:function(e){return!0===e.favorited},unfavorite:function(e){return!1===e.favorited}},cases:{favorite:l,unfavorite:c}}),{favoriteArticleToggled:t,setUnfavoriteArticleFx:l,$feed:d,$totalPages:m,$articles:v,$isEmptyFeed:h}}var v=t(4246),p=function(e){var r=e.children;return(0,v.jsx)("ul",{className:"articles-wrapper list-unstyled",children:r})},h=t(7378),j=t(4289),b=(0,h.memo)((function(e){var r=e.author,t=e.createdAt,n=e.children;return(0,v.jsxs)("div",{className:"article-meta",children:[(0,v.jsx)(j.rU,{to:"/@".concat(r.username),children:(0,v.jsx)("img",{alt:r.username,src:r.image})}),(0,v.jsxs)("div",{className:"info",children:[(0,v.jsx)(j.rU,{className:"author",to:"/@".concat(r.username),children:r.username}),(0,v.jsx)("span",{className:"date",children:new Date(t).toDateString()})]}),n]})}));b.displayName="ArticleMeta";var g=t(6455),x=function(e){var r=e.slug,t=e.favorited,n=e.favoritesCount,o=e.onClick,a=e.children;return(0,v.jsxs)(g.zx,{className:"button-favorite btn-outline-primary","data-active":t,size:"sm",onClick:function(){o({slug:r,favorited:t,favoritesCount:n})},children:[(0,v.jsx)("i",{className:"ion-heart"})," ",a]})},y=(0,h.memo)((function(e){var r=e.author,t=e.createdAt,n=e.slug,o=e.title,a=e.description,i=e.tagList,c=e.favorited,s=e.favoritesCount,u=e.onFavoriteToggle;return(0,v.jsxs)("article",{className:"article-preview",children:[(0,v.jsx)(b,{author:r,createdAt:t,children:(0,v.jsx)("div",{className:"pull-xs-right",children:(0,v.jsx)(x,{favorited:c,favoritesCount:s,slug:n,onClick:u,children:s})})}),(0,v.jsxs)(j.rU,{className:"preview-link",to:"/article/".concat(n),children:[(0,v.jsx)("h1",{children:o}),(0,v.jsx)("p",{children:a}),(0,v.jsx)("span",{children:"Read more..."}),(0,v.jsx)(g.oS,{children:i.map((function(e){return(0,v.jsx)(g.Vp,{children:e.toLowerCase()},e)}))})]})]})}));y.displayName="Article Preview";var O=function(e){return e.show?(0,v.jsx)("div",{className:"empty-articles article-preview",children:"No articles are here... yet."}):null},w=t(9041),P=function(e){var r=e.loading,t=e.isEmpty,n=e.articlesStore,o=e.onFavoriteToggle;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(O,{show:t}),(0,v.jsx)(p,{children:(0,w.sm)(n,{getKey:function(e){return e.slug},fn:function(e){return(0,v.jsx)("li",{children:(0,v.jsx)(y,{author:e.author,createdAt:e.createdAt,description:e.description,favorited:e.favorited,favoritesCount:e.favoritesCount,slug:e.slug,tagList:e.tagList,title:e.title,onFavoriteToggle:o})})}})}),(0,v.jsx)(g.$j,{show:r})]})}},1837:function(e,r,t){t.r(r),t.d(r,{default:function(){return me}});var n=t(7378),o=t(9635),a=t(4931),i=t(8039),c=t(6455),s=t(1549),u=t(9041),l=t(6942);function f(e,r,t,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?r(s):Promise.resolve(s).then(n,o)}function d(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function i(e){f(a,n,o,i,c,"next",e)}function c(e){f(a,n,o,i,c,"throw",e)}i(void 0)}))}}var m=function(){var e=d(regeneratorRuntime.mark((function e(r){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.U2("articles/".concat(r,"/comments"));case 2:return t=e.sent,n=t.data,e.abrupt("return",n.comments);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),v=function(){var e=d(regeneratorRuntime.mark((function e(r){var t,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.slug,n=r.body,e.next=3,l.v_("articles/".concat(t,"/comments"),{comment:{body:n}});case 3:return o=e.sent,a=o.data,e.abrupt("return",a.comment);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),p=(0,s.yM)(),h=(0,s.GW)(m),j=(0,s.GW)(v),b=(0,s.GW)((function(e){var r=e.slug,t=e.id;l.IV("articles/".concat(r,"/comments/").concat(t))}));(0,s.eH)({from:p,to:b});var g=(0,s.nu)(h.doneData,[]).on(j.doneData,(function(e,r){return[r].concat(e)})).on(b.done,(function(e,r){var t=r.params;return e.filter((function(e){return e.id!==t.id}))})),x=(0,u.Bq)(),y=(0,s.MT)({errors:{}}).on([j.failData,b.failData],(function(e,r){var t;return null===(t=r.response)||void 0===t?void 0:t.data})).reset(x.close),O=y.map((function(e){return Object.keys(Object(e)).length>0})),w=y.map((function(e){return Object.entries(Object(null==e?void 0:e.errors))})),P=function(){return(0,u.oR)(O)},N=function(){return(0,u.oR)(w)},D=t(4246),C=function(){var e=a.wl.useVisitor(),r=e.image,t=e.username;return(0,D.jsxs)("div",{className:"card-footer",children:[(0,D.jsx)("img",{alt:t,className:"comment-author-img",src:r}),(0,D.jsx)(c.zx,{className:"btn-primary",size:"sm",type:"submit",children:"Post Comment"})]})};function k(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function A(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?k(Object(t),!0).forEach((function(r){S(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function S(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function R(){var e=function(){var e={body:""},r=(0,o.UO)().slug,t=(0,i.cI)({defaultValues:e}),a=t.handleSubmit,c=t.register,s=t.reset;return(0,n.useEffect)((function(){var r=j.done.watch((function(){s(e)}));return function(){return r()}})),{register:c,handleSubmit:a((function(e){var t=e.body;j({body:t,slug:r})}))}}(),r=e.handleSubmit,t=e.register;return(0,D.jsxs)(c.l0,{className:"card comment-form",onSubmit:r,children:[(0,D.jsx)("div",{className:"card-block",children:(0,D.jsx)(c.l0.Control,A({as:"textarea",placeholder:"Write a comment...",rows:3},t("body")))}),(0,D.jsx)(C,{})]})}var E=t(4289),U=function(e){var r=e.author,t=e.onClick,n=a.wl.useVisitor().username,o=a.wl.useIsAuthorized(),i=n===r.username;return o&&i?(0,D.jsx)(c.zx,{className:"mod-options btn-delete",onClick:t,children:(0,D.jsx)("i",{className:"ion-trash-a"})}):null},z=function(e){var r=e.author,t=e.createdAt,n=e.id,a=(0,o.UO)().slug;return(0,D.jsxs)("div",{className:"card-footer",children:[(0,D.jsx)(E.rU,{className:"comment-author",to:"/@".concat(r.username),children:(0,D.jsx)("img",{alt:r.username,className:"comment-author-img",src:r.image})})," ",(0,D.jsx)(E.rU,{className:"comment-author",to:"/@".concat(r.username),children:r.username}),(0,D.jsx)("span",{className:"date-posted",children:new Date(t).toDateString()}),(0,D.jsx)(U,{author:r,onClick:function(){p({slug:a,id:n})}})]})},V=["body"];function I(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function L(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?I(Object(t),!0).forEach((function(r){W(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function W(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function F(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var G=function(e){var r=e.body,t=F(e,V);return(0,D.jsxs)("div",{className:"card",children:[(0,D.jsx)("div",{className:"card-block",children:(0,D.jsx)("p",{className:"card-text",children:r})}),(0,D.jsx)(z,L({},t))]})},M=function(){var e=(0,o.UO)().slug;return(0,n.useEffect)((function(){e&&h(e)}),[e]),(0,D.jsx)(c.aV,{children:(0,u.sm)(g,{getKey:function(e){return e.id},fn:function(e){return(0,D.jsx)(G,{author:e.author,body:e.body,createdAt:e.createdAt,id:e.id})}})})},T=function(){(0,u.DD)(x);var e=P(),r=N();return e?(0,D.jsx)(c.KM,{errors:r}):null},$=function(){return a.wl.useIsAuthorized()?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(T,{}),(0,D.jsx)(R,{}),(0,D.jsx)(M,{})]}):null},q=t(9721),K=["createdAt"];function H(e,r,t,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void t(e)}c.done?r(s):Promise.resolve(s).then(n,o)}function X(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?X(Object(t),!0).forEach((function(r){B(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function B(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Z(e,r){if(null==e)return{};var t,n,o=function(e,r){if(null==e)return{};var t,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||(o[t]=e[t]);return o}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)t=a[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var J=function(){var e,r=(e=regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.IV("articles/".concat(r));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})),function(){var r=this,t=arguments;return new Promise((function(n,o){var a=e.apply(r,t);function i(e){H(a,n,o,i,c,"next",e)}function c(e){H(a,n,o,i,c,"throw",e)}i(void 0)}))});return function(e){return r.apply(this,arguments)}}(),Q=(0,s.yM)(),Y=(0,s.GW)((function(e){return l.U2("articles/".concat(e)).then((function(e){return e.data.article})).then((function(e){var r=e.createdAt;return _(_({},Z(e,K)),{},{createdAt:new Date(r).toDateString()})}))})),ee=(0,s.GW)(J),re=(0,s.nu)(Y.doneData,{title:"",slug:"",body:"",createdAt:"",updatedAt:"",tagList:[],description:"",author:{username:"",bio:"",image:"",following:!1},favorited:!1,favoritesCount:0}),te=(0,s.$e)(re,a.Sj,(function(e,r){return e.author.username===r.username}));(0,s.eH)({from:Q,to:ee}),ee.done.watch((function(){q.m8.push("/")}));var ne=function(){return(0,u.oR)(Y.pending)},oe=function(){return(0,u.oR)(te)},ae=function(){return(0,u.oR)(re)},ie=t(8781),ce=function(){var e=ae().tagList;return(0,D.jsx)(c.oS,{children:e.map((function(e){return(0,D.jsx)(c.Vp,{children:e.toLowerCase()},e)}))})},se=function(){var e=ae().body;return(0,D.jsx)(c.X2,{className:"article-content",children:(0,D.jsxs)("div",{className:"col-xs-12",children:[(0,D.jsx)(ie.Z,{children:e}),(0,D.jsx)(ce,{})]})})},ue=t(8012),le=function(){var e=oe(),r=ae().slug;return e?(0,D.jsxs)("span",{children:[(0,D.jsx)(E.rU,{to:"/editor/".concat(r),children:(0,D.jsxs)(c.zx,{className:"btn-outline-secondary",size:"sm",children:[(0,D.jsx)("i",{className:"ion-edit"})," Edit Article"]})}),(0,D.jsxs)(c.zx,{className:"btn-sm btn-outline-danger",onClick:function(){Q(r)},children:[(0,D.jsx)("i",{className:"ion-trash-a"})," Delete Article"]})]}):null},fe=function(){var e=ae(),r=e.title,t=e.author,n=e.createdAt;return(0,D.jsx)(c.jL,{children:(0,D.jsxs)(c.W2,{children:[(0,D.jsx)("h1",{children:r}),(0,D.jsx)(ue.qn,{author:t,createdAt:n,children:(0,D.jsx)(le,{})})]})})},de=function(){return a.wl.useIsAuthorized()?null:(0,D.jsxs)("p",{children:[(0,D.jsx)(E.rU,{to:"/login",children:"Sign in"})," or ",(0,D.jsx)(E.rU,{to:"/register",children:"sign up"})," to add comments on this article."]})},me=function(){var e=(0,o.UO)().slug,r=ne();return(0,n.useLayoutEffect)((function(){e&&Y(e)}),[e]),r?null:(0,D.jsxs)("div",{className:"article-page",children:[(0,D.jsx)(fe,{}),(0,D.jsxs)(c.T3,{children:[(0,D.jsx)(se,{}),(0,D.jsx)("hr",{}),(0,D.jsx)("div",{className:"article-actions"}),(0,D.jsx)(c.X2,{children:(0,D.jsxs)("div",{className:"col-xs-12 col-md-8 offset-md-2",children:[(0,D.jsx)($,{}),(0,D.jsx)(de,{})]})})]})]})}}}]);